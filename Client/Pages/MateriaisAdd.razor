@page "/materiais/{Category}/addMaterial"
@using Microsoft.AspNetCore.Authorization
@using Shared.DTOs
@attribute [Authorize(Roles = "Master, User")]
@inject HttpClient Http
@inject NavigationManager Nav

<h3>Add Material - @Category</h3>

<div class="mb-3">
    <label>Material Name</label>
    <input class="form-control" @bind="Name" />
</div>

<div class="mb-3">
    <label>Quantity</label>
    <input type="number" class="form-control" @bind="Quantity" min="0" />
</div>

<button class="btn btn-success" @onclick="Create">Save</button>
<button class="btn btn-secondary ms-2" @onclick="Cancel">Cancel</button>

@code {
    [Parameter] public string Category { get; set; } = string.Empty;
    private string Name = "";
    private int Quantity = 0;

    async Task Create()
    {
        var request = new MaterialCreateRequest(Name, Category, Quantity);
        var result = await Http.PostAsJsonAsync("materials", request);

        if (result.IsSuccessStatusCode)
        {
            Nav.NavigateTo($"/materiais/{Category}");
        }
    }

    void Cancel()
    {
        Nav.NavigateTo($"/materiais/{Category}");
    }
} 
