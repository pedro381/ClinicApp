@page "/dashboard"
@using Microsoft.AspNetCore.Authorization

@attribute [Authorize(Roles = "Master")]
@inject DashboardService DashboardService

<h3>General Dashboard</h3>

@if (summary == null)
{
    <p>Loading...</p>
}
else
{
    <div class="row">
        @foreach (var c in summary.Clinics)
        {
            <div class="card m-2 p-2" style="width:220px;">
                <h5>@c.ClinicName</h5>
                <p>Distinct materials: @c.DistinctMaterials</p>
                <p>Total in stock: @c.TotalQuantity</p>
            </div>
        }
    </div>

    <div class="mt-4">
        <p>Total clinics: @summary.TotalClinics</p>
        <p>Total distinct materials (sum): @summary.TotalMaterials</p>
        <p>Total units in stock: @summary.TotalQuantity</p>
    </div>
}

@code {
    Shared.DTOs.DashboardSummaryDto? summary;
    protected override async Task OnInitializedAsync()
    {
        summary = await DashboardService.GetSummary();
    }
}
